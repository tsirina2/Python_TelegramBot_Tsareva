# Проект: Telegram-бот с функцией календаря
<aside>
⚡Этот проект поможет закрепить навыки, которые вы получите по мере прохождения курса. Вы напишете Telegram-бот с функцией календаря, который положите в портфолио. Проект состоит из двух частей. Выполните первую часть в конце модуля «Потоки, процессы и асинхронность», а вторую — в конце модуля «Подготовка к запуску».
</aside>

## Как выполнить проект
1. Скачайте код приложения для заметок из [этой ветки](https://github.com/EdusonPython/Python-Projects/tree/telegram-bot-part1).
2. Прочитайте и выполните задания первой части проекта по порядку. При необходимости пользуйтесь подсказками. Нажмите на треугольник рядом со словом «Подсказка», чтобы раскрыть ее.
3. Если у вас возникнут трудности, обратитесь к урокам, в которых разбирается тема. Для первой части проекта вам понадобятся лекции из модулей «Углубленное программирование», «Основы объектно-ориентированного программирования», «Качественный код», «Работа с базами данных» и «Потоки, процессы и асинхронность».
4. Обратитесь в поддержку, если у вас возникнут вопросы по заданию.

## Как сдать проект через Github
1. Создайте репозиторий с названием: **“Python_TelegremBot_Familiya”**. Вместо Familiya напишите свою фамилию латиницей.
2. Добавьте в репозиторий файл Readme. Заполните его по шаблону:

    > Проект: Telegram-бот с функцией календаря <br>
    > Имя Фамилия — укажите свое имя и фамилию <br>
    > логин на GitHub — укажите имя пользователя (логин) на GitHub <br>
    > e-mail — укажите свой e-mail
4. Предоставьте код-ревьюеру доступ к вашему проекту.
    - Зайдите в **“Settings”** репозитория, выберите в левом столбце вкладку **“Collaborators”**.
    - Нажмите **“Add people”.** В появившемся окне впишите юзернейм **EdusonCodeReview**. Выберите его и нажмите **“Add EdusonCodeReview to this repository”.**
5. Создайте новую ветку для проекта в репозитории. В названии ветки должно быть название проекта и номер части. Для первой части это может быть, например: **“bot-part1”** или **“telegram-bot-part1”**.
6. Сделайте коммит кода в ветке задания.
7. Отправьте куратору курса ссылку на ваш репозиторий и на нужную ветку в нем. Сообщите, что передаете задание на проверку.
8. После того, как код-ревьюер проверит задание, внесите правки в решение.
9. Сделайте pull request из ветки с заданием в основную ветку проекта (main), затем сделайте слияние (merge) веток.
<p><aside>
⚡Код-ревьюер проверяет каждое решение и пишет подробный отзыв на результаты работы. Проверка работы занимает до 7 рабочих дней.
</aside></p>

## Задание №1. Подготовьте код приложения для заметок, чтобы перенести его в Telegram-бот
Прежде чем создать бота, скачайте код приложения для заметок из [этой ветки](https://github.com/EdusonPython/Python-Projects/tree/telegram-bot-part1). На первых этапах работы с ботом добавьте в него функцию заметок, которую разработали ранее. Добавьте функцию календаря позже в соотвествии с последовательностью заданий. 

## Задание №2. Подключите бота к Telegram
Используйте Telegram API, чтобы создать бота в Telegram. 

1. Сделайте запрос в **BotFather** в Telegram, чтобы создать нового бота. Для этого введите в него команду `/newbot` и следуйте инструкциям. Вы получите уникальный токен API для бота.

2. Вынесите API_TOKEN в отдельный файл `secrets.py`, который импортируется в боте.
Добавьте `secrets.py` в `.gitignore`, чтобы этот файл случайно не попал на GitHub.

3. Установите библиотеку `python-telegram-bot`. Для этого запустите `pip install python-telegram-bot==13.13`.

4. Импортируйте модуль `telegram` и классы `Updater`, `CommandHandler`, `MessageHandler`, `Filters` в свой код. Для этого введите: 
    
    ```python
    import telegram
    from telegram.ext import Updater, CommandHandler, MessageHandler, Filters
    ```
    
5. Инициализируйте объект `Updater` с помощью токена API:
    
    ```python
    updater = Updater(token="API_TOKEN")
    ```
    
6. Создайте обработчики (handlers) для каждого действия, которое выполняет бот.
   
   <details>
    <summary>Подсказка</summary>
       
   Изучите пример кода обработчика для создания заметок `create_note_handler(update, context)`.
      
    ```python
        # Создать обработчик для создания заметок create_handler
        def create_note_handler(update, context):
            try:
                # Получить текст заметки из сообщения пользователя
                note_text = update.message.text
                # Получить название заметки из сообщения пользователя
                note_name = update.message.chat_id
                # Создать заметку с помощью функции create_note(note_text, note_name)
                create_note(note_text, note_name)
                # Отправить пользователю подтверждение, что заметка создана
                context.bot.send_message(chat_id=update.message.chat_id, text=f"Заметка {note_name} создана.")
            except:
    
                # Отправить пользователю сообщение об ошибке
                context.bot.send_message(chat_id=update.message.chat_id, text="Произошла ошибка.")
    
        # Добавить функцию create_note_handler как CommandHandler для команды /create
        updater.dispatcher.add_handler(CommandHandler('create', create_note_handler))
    ```
  
    </details> 
    
    Заметьте, что обработчики получают ввод пользователя и выдают ему результат работы функций.
    
8. Повторите предыдущий шаг для каждого действия, которое выполняет бот (чтение, редактирование, удаление заметок, отображение всех заметок, отображение всех заметок в отсортированном виде).

9. Запустите приложение. Для этого введите команду: 
    
    ```python
    updater.start_polling()
    ```
## Задание №3. Добавьте в приложение класс `calendar`
1. Добавьте в приложение класс `Calendar` который будет содержать методы для создания, чтения, редактирования и удаления событий, а также отображения всех событий. Для работы с календарем вам потребуются библиотеки `os` и `datetime`. Импортируйте их в начале кода.
   
<details>
    
    <summary>Подсказка</summary>

    ```python
        # Создать класс Calendar
        class Calendar:
            def __init__(self):
                self.events = {}
        
        # Создать метод create_event
            def create_event(self, event_name, event_date, event_time, event_details):
                event_id = len(self.events) + 1
                event = {
                    "id": event_id,
                    "name": event_name,
                    "date": event_date,
                    "time": event_time,
                    "details": event_details
                }
                self.events[event_id] = event
                return event_id
        ```
        
</details>

    Аналогично добавьте методы для остальных операций с событиями.
    
3. Добавьте и зарегистрируйте обработчики команд для создания, чтения, редактирования и удаления событий, а также отображения всех событий. 
    - Подсказка: пример кода, который создает обработчик для создания событий **`create_event_handler(update, context)`**
        
        ```python
        # Зададим глобально доступный объект календаря
        calendar = Calendar()
        
        # Создать обработчик для создания событий 
        def event_create_handler(update, context):
            try:
                # Взять данные о событии из сообщения пользователя
                event_name = update.message.text[14:]
                event_date = "2023-03-14"
                event_time = "14:00"
                event_details = "Описание события"
        
                # Создать событие с помощью метода create_event класса Calendar
                event_id = calendar.create_event(event_name, event_date, event_time, event_details)
        
                # Отправить пользователю подтверждение
                context.bot.send_message(chat_id=update.message.chat_id, text=f"Событие {event_name} создано и имеет номер {event_id}.")
            except:
                # Отправить пользователю сообщение об ошибке
                context.bot.send_message(chat_id=update.message.chat_id, text="При создании события произошла ошибка.")
        
        # Зарегистрировать обработчик, чтобы он вызывался по команде /create_event
        updater.dispatcher.add_handler(CommandHandler('create_event', event_create_handler))
        ```
        
4. Затем включите этот класс в основную функцию приложения (функция **`main()`**), чтобы дать пользователю возможность создавать, читать, редактировать и удалять события, а также отображать весь список событий.
